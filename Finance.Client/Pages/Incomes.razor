@page "/"
@inherits IncomeBase

<PageTitle>Income</PageTitle>

<h1>Доходы</h1>

<div class="row mb-4">
	<div class="col-sm-2">
		<button type="button" class="btn btn-primary" @onclick="HandleSumbit">
			Новый доход
		</button>
	</div>
	@if(Currencies == null)
	{
		<h2>Нет валют</h2>
	}
	else
	{
		<div class="col-sm-2">
			<select class="form-select" @onchange="ChangeCurrency">
				<option value="0">Выберите валюту</option>
				@foreach (var currency in Currencies)
				{
					<option value="@currency.Id">@currency.CurrencyName</option>
				}
			</select>
		</div>
	}
</div>


@if(Incomes == null)
{
	<h2>Загрузка доходов</h2>
}
else
{
	<DisplayTableIncome Incomes="@FilteredIncomes()"></DisplayTableIncome>
}



<table class="table table-striped table-bordered table-hover">
	<thead class="table-dark">
	<th>Категория</th>
	<th>Общая сумма</th>
	</thead>
	<tbody>
		@{
			Dictionary<string, decimal> categoryAmounts = Incomes
			.GroupBy(i => i.Category.CategoryIncomeName)
			.ToDictionary(g => g.Key, g => g.Sum(i => i.Amount));
		}
		@foreach (var categoryIncome in categoryAmounts)
		{
			<tr>
				<td>@categoryIncome.Key</td>
				<td>@categoryIncome.Value</td>
			</tr>
		}
	</tbody>
</table>



